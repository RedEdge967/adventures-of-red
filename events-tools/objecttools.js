var gdjs;(function(c){let y;(function(j){let w;(function(p){p.pickOnly=function(e,t){for(const n in e.items)if(e.items.hasOwnProperty(n)){const l=e.items[n];l.indexOf(t)===-1?l.length=0:(l.length=0,l.push(t))}},p.twoListsTest=function(e,t,n,l,o){let u=!1;const r=c.staticArray(c.evtTools.object.twoListsTest);t.values(r);const f=c.staticArray2(c.evtTools.object.twoListsTest);n.values(f);for(let a=0,h=r.length;a<h;++a){let i=r[a];for(let s=0,g=i.length;s<g;++s)i[s].pick=!1}for(let a=0,h=f.length;a<h;++a){let i=f[a];for(let s=0,g=i.length;s<g;++s)i[s].pick=!1}for(let a=0,h=r.length;a<h;++a){const i=r[a];for(let s=0,g=i.length;s<g;++s){let T=!1;for(let b=0,k=f.length;b<k;++b){const m=f[b];for(let O=0,d=m.length;O<d;++O)i[s].pick&&m[O].pick||i[s].id!==m[O].id&&e(i[s],m[O],o)&&(l||(u=!0,i[s].pick=!0,m[O].pick=!0),T=!0)}!T&&l&&(u=!0,i[s].pick=!0)}}for(let a=0,h=r.length;a<h;++a){let i=r[a],s=0;for(let g=0,T=i.length;g<T;++g){let b=i[g];i[g].pick&&(i[s]=b,s++)}i.length=s}if(!l)for(let a=0,h=f.length;a<h;++a){let i=f[a],s=0;for(let g=0,T=i.length;g<T;++g){let b=i[g];i[g].pick&&(i[s]=b,s++)}i.length=s}return u},p.pickObjectsIf=function(e,t,n,l){let o=!1;const u=c.staticArray(c.evtTools.object.pickObjectsIf);t.values(u);for(let r=0,f=u.length;r<f;++r){const a=u[r];for(let h=0,i=a.length;h<i;++h){const s=a[h];n^e(s,l)?(o=!0,s.pick=!0):s.pick=!1}}for(let r=0,f=u.length;r<f;++r)c.evtTools.object.filterPickedObjectsList(u[r]);return o},p.filterPickedObjectsList=function(e){let t=0;for(let n=0,l=e.length;n<l;++n){const o=e[n];o.pick&&(e[t]=o,t++)}e.length=t},p.hitBoxesCollisionTest=function(e,t,n,l,o){return c.evtTools.object.twoListsTest(c.RuntimeObject.collisionTest,e,t,n,o)},p._distanceBetweenObjects=function(e,t,n){return e.getSqDistanceToObject(t)<=n},p.distanceTest=function(e,t,n,l){return c.evtTools.object.twoListsTest(c.evtTools.object._distanceBetweenObjects,e,t,l,n*n)},p._movesToward=function(e,t,n){if(e.hasNoForces())return!1;let l=Math.atan2(t.getDrawableY()+t.getCenterY()-(e.getDrawableY()+e.getCenterY()),t.getDrawableX()+t.getCenterX()-(e.getDrawableX()+e.getCenterX()));return l*=180/3.14159,Math.abs(c.evtTools.common.angleDifference(e.getAverageForce().getAngle(),l))<=n/2},p.movesTowardTest=function(e,t,n,l){return c.evtTools.object.twoListsTest(c.evtTools.object._movesToward,e,t,l,n)},p._turnedToward=function(e,t,n){let l=Math.atan2(t.getDrawableY()+t.getCenterY()-(e.getDrawableY()+e.getCenterY()),t.getDrawableX()+t.getCenterX()-(e.getDrawableX()+e.getCenterX()));return l*=180/3.14159,Math.abs(c.evtTools.common.angleDifference(e.getAngle(),l))<=n/2},p.turnedTowardTest=function(e,t,n,l){return c.evtTools.object.twoListsTest(c.evtTools.object._turnedToward,e,t,l,n)},p.pickAllObjects=function(e,t){for(const n in t.items)if(t.items.hasOwnProperty(n)){const l=e.getObjects(n),o=t.items[n];o.length=0,o.push.apply(o,l)}return!0},p.pickRandomObject=function(e,t){let n=0;for(let r in t.items)t.items.hasOwnProperty(r)&&(n+=t.items[r].length);if(n===0)return!1;let l=Math.floor(Math.random()*n);l>=n&&(l=n-1);let o=0,u=null;for(let r in t.items)if(t.items.hasOwnProperty(r)){let f=t.items[r];if(l-o<f.length){u=f[l-o];break}o+=f.length}return c.evtTools.object.pickOnly(t,u),!0},p.pickNearestObject=function(e,t,n,l){let o=null,u=0,r=!0;const f=c.staticArray(c.evtTools.object.pickNearestObject);e.values(f);for(let a=0,h=f.length;a<h;++a){const i=f[a];for(let s=0;s<i.length;++s){const g=i[s],T=g.getSqDistanceToPosition(t,n);(r||T<u^l)&&(u=T,o=g),r=!1}}return o?(c.evtTools.object.pickOnly(e,o),!0):!1},p.raycastObject=function(e,t,n,l,o,u,r,f){return c.evtTools.object.raycastObjectToPosition(e,t,n,t+o*Math.cos(l*Math.PI/180),n+o*Math.sin(l*Math.PI/180),u,r,f)},p.raycastObjectToPosition=function(e,t,n,l,o,u,r,f){let a=null,h=f?0:(l-t)*(l-t)+(o-n)*(o-n),i=0,s=0;const g=c.staticArray(c.evtTools.object.raycastObjectToPosition);e.values(g);for(let T=0;T<g.length;T++){const b=g[T];for(let k=0;k<b.length;k++){const m=b[k],O=m.raycastTest(t,n,l,o,!f);O.collision&&(!f&&O.closeSqDist<=h?(h=O.closeSqDist,a=m,i=O.closeX,s=O.closeY):f&&O.farSqDist>=h&&(h=O.farSqDist,a=m,i=O.farX,s=O.farY))}}return a?(c.evtTools.object.pickOnly(e,a),u.setNumber(i),r.setNumber(s),!0):!1},p.doCreateObjectOnScene=function(e,t,n,l,o,u){const r=e.createObject(t),f=e.getLayer(u);r!==null&&(r.setPosition(l,o),r.setLayer(u),r.setZOrder(f.getDefaultZOrder()),n.containsKey(t)&&n.get(t).push(r))},p.createObjectOnScene=function(e,t,n,l,o){c.evtTools.object.doCreateObjectOnScene(e,t.firstKey(),t,n,l,o)},p.createObjectFromGroupOnScene=function(e,t,n,l,o,u){c.evtTools.object.doCreateObjectOnScene(e,n,t,l,o,u)},p.pickedObjectsCount=function(e){let t=0;const n=c.staticArray(c.evtTools.object.pickedObjectsCount);e.values(n);for(let l=0,o=n.length;l<o;++l)t+=n[l].length;return t}})(w=j.object||(j.object={}))})(y=c.evtTools||(c.evtTools={}))})(gdjs||(gdjs={}));
//# sourceMappingURL=objecttools.js.map
