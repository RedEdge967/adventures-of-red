var gdjs;(function(d){const f=new d.Logger("Font manager");class l{constructor(t){this._loadedFontFamily={};this._loadedFonts={};this._filenameToFontFamily={};this._resources=t}setResources(t){this._resources=t}getFontFamily(t){return this._loadedFontFamily[t]?this._loadedFontFamily[t]:"Arial"}getFontFile(t){return this._loadedFonts[t]?this._loadedFonts[t].file||"":t}_getFontFamilyFromFilename(t){if(this._filenameToFontFamily[t])return this._filenameToFontFamily[t];let i="gdjs_font_"+t.toLowerCase().replace(/[^\w]/gi,"-");const r=i;let n=2;for(;this._filenameToFontFamily[i];)i=i+"-"+n,n++;return this._filenameToFontFamily[t]=r}static _loadFont(t,i){const r={},n="url("+encodeURI(i)+")";if(typeof FontFace!="undefined"){const o=new FontFace(t,n,r);return document.fonts.add(o),o.load()}else{const o=document.createElement("style");return o.appendChild(document.createTextNode("@font-face { font-family: '"+t+"'; src: "+n+"; }")),document.head.appendChild(o),new FontFaceObserver(t,r).load()}}loadFonts(t,i){const r=this._resources,n={};for(let s=0,a=r.length;s<a;++s){const e=r[s];if(e.file&&e.kind==="font"){if(this._loadedFonts[e.name])continue;n[e.file]=n[e.file]?n[e.file].concat(e):[e]}}const o=Object.keys(n).length;if(o===0)return i(o);let c=0;const F=this;function u(s,a){a.forEach(function(e){F._loadedFontFamily[e.name]=s,F._loadedFonts[e.name]=e}),c++,t(c,o),c===o&&i(o)}Object.keys(n).forEach(function(s){const a=F._getFontFamilyFromFilename(s),e=n[s];l._loadFont(a,s).then(function(){u(a,e)},function(g){f.error('Error loading font resource "'+e[0].name+'" (file: '+s+"): "+(g.message||"Unknown error")),u(a,e)})})}}d.FontFaceObserverFontManager=l,d.FontManager=l})(gdjs||(gdjs={}));
//# sourceMappingURL=fontfaceobserver-font-manager.js.map
